<template>
  <div v-if="code">
    <div ref="svg" id="qrcode" class="text-center" />
    <p class="text-center" v-if="showCode">{{ text }}</p>
  </div>
</template>

<script>
import { mapGetters } from 'vuex'
import QRCodeStyling from 'qr-code-styling'

const imageData = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iMTM1LjQ2NjY2bW0iCiAgIGhlaWdodD0iMTM1LjQ2NjY2bW0iCiAgIHZpZXdCb3g9IjAgMCAxMzUuNDY2NjYgMTM1LjQ2NjY2IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmczODk0IgogICBzb2RpcG9kaTpkb2NuYW1lPSJncmlkc2NvcmUtbmV4dC10ZXh0LnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4yLjIgKDczMmEwMWRhNjMsIDIwMjItMTItMDkpIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0ibmFtZWR2aWV3Mzg5NiIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnNob3dwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZWNoZWNrZXJib2FyZD0iMCIKICAgICBpbmtzY2FwZTpkZXNrY29sb3I9IiNkMWQxZDEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9Im1tIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIyLjgyODQyNzEiCiAgICAgaW5rc2NhcGU6Y3g9IjE4OC43OTc1MSIKICAgICBpbmtzY2FwZTpjeT0iMzcxLjkzODE3IgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMjU2MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMzc3IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIxOTEyIgogICAgIGlua3NjYXBlOndpbmRvdy15PSItOCIKICAgICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgaWQ9ImdyaWQ4MjIzIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxkZWZzCiAgICAgaWQ9ImRlZnMzODkxIiAvPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI5LjE4ODcxOSwtOC4zMjM0NDkxKSI+CiAgICA8cmVjdAogICAgICAgc3R5bGU9ImZpbGw6IzM0NDk1ZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC43OTQ7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOmJldmVsO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgIGlkPSJyZWN0MTQ2MzMiCiAgICAgICB3aWR0aD0iMTM1LjQ2NjY2IgogICAgICAgaGVpZ2h0PSIxMzUuNDY2NjYiCiAgICAgICB4PSItMjkuMTg4NzE5IgogICAgICAgeT0iOC4zMjM0NDkxIgogICAgICAgcnk9IjAiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojOTEwMDgwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjQ1NzYxODtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQiCiAgICAgICBpZD0iY2lyY2xlMTM1MTEiCiAgICAgICBjeD0iLTI5LjQ5MzQzMyIKICAgICAgIGN5PSI0NS4zNzQxMTkiCiAgICAgICByPSIyOC41OTIwNTIiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii02Ny43MzMzMyIKICAgICAgIHRyYW5zZm9ybT0icm90YXRlKC00Ni44NDA1MDkpIiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6I2ZmN2MwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC40NTc2MTg7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kIgogICAgICAgaWQ9ImNpcmNsZTEzNTE1IgogICAgICAgY3g9IjY0Ljk3ODU3NyIKICAgICAgIGN5PSIxOS41OTI2NTEiCiAgICAgICByPSIyOC41OTIwNTIiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii0yMC45MzA3NTIiCiAgICAgICB0cmFuc2Zvcm09InJvdGF0ZSgyNS4xNTk0OTEpIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci14PSItNjQuNDE4MjI1IiAvPgogICAgPGNpcmNsZQogICAgICAgc3R5bGU9ImZpbGw6IzVlYzQxODtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC40NTc2MTg7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kIgogICAgICAgaWQ9ImNpcmNsZTEzNTE3IgogICAgICAgY3g9IjY5LjY1MjQwNSIKICAgICAgIGN5PSItNzguMjIyNDgxIgogICAgICAgcj0iMjguNTkyMDUyIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci15PSI1NC43OTc0MDkiCiAgICAgICB0cmFuc2Zvcm09InJvdGF0ZSg5Ny4xNTk0OTEpIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci14PSItMzkuODEyNjUiIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojMDBhMGYxO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjQ1NzYxODtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQiCiAgICAgICBpZD0iY2lyY2xlMTM1MTkiCiAgICAgICBjeD0iLTIxLjkzMTAyNiIKICAgICAgIGN5PSItMTEyLjg5NDA5IgogICAgICAgcj0iMjguNTkyMDUyIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci15PSI1NC43OTc0MTIiCiAgICAgICB0cmFuc2Zvcm09InJvdGF0ZSgxNjkuMTU5NDkpIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci14PSIzOS44MTI2NDciIC8+CiAgICA8Y2lyY2xlCiAgICAgICBzdHlsZT0iZmlsbDojYzVlMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjQ1NzYxODtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQiCiAgICAgICBpZD0iY2lyY2xlMTM1MjEiCiAgICAgICBjeD0iLTgzLjIwNjUyOCIKICAgICAgIGN5PSItMzYuNTA3MTkxIgogICAgICAgcj0iMjguNTkyMDUyIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci15PSItMjAuOTMwNzQ0IgogICAgICAgdHJhbnNmb3JtPSJyb3RhdGUoLTExOC44NDA1MSkiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXg9IjY0LjQxODIyMSIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0iY2lyY2xlMTQzMzgiCiAgICAgICBzdHlsZT0iZmlsbDojZmY3YzgwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjQ1NzYxODtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii02Ny43MzMzMyIKICAgICAgIGQ9Ik0gMjcuNzE2MDI0LDI4LjA4NDM2NiBBIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMjQuNjA0ODY3LDMzLjIwMzI1NCAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDM1LjY5NzA4LDY5LjgwNzY0NCAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDMyLjQ4MTY5LDMxLjY5NDg0MSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDI3LjcxNjAyNCwyOC4wODQzNjYgWiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0iY2lyY2xlMTQzNDgiCiAgICAgICBzdHlsZT0iZmlsbDojNWVlOWYyO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjQ1NzYxODtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXg9Ii0zOS44MTI2NSIKICAgICAgIGlua3NjYXBlOnRyYW5zZm9ybS1jZW50ZXIteT0iNTQuNzk3NDA5IgogICAgICAgZD0ibSA0MC4zNjQ5MzQsNzguMjY0NzYgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDI1LjAwMzE0NiwyOC45NjI3MiAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDUuOTc3NTk5LDAuMTA4IDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgLTAuNDkxNTUyLC01Ljk1ODM0IDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgLTMwLjQ4OTE5MywtMjMuMTEyMzggeiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0iY2lyY2xlMTQzNjkiCiAgICAgICBzdHlsZT0iZmlsbDojZmZlMTE4O2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjQ1NzYxODtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXg9Ii02NC40MTgyMjUiCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii0yMC45MzA3NTIiCiAgICAgICBkPSJNIDQ3LjQ5OTQwNiw1OS45MzMxMzUgQSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDQxLjEwOTg4OCw3Mi4zNDk5MjQgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCA3Ni4zNjM3OTcsNTcuNTE0MzEzIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgNzguMzI3MzI1LDUxLjg1NTQ4NyAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDcyLjQ5NTI0Nyw1MC40ODkyNjggMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCA0Ny40OTk0MDYsNTkuOTMzMTM1IFoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9ImNpcmNsZTE0NDQ3IgogICAgICAgc3R5bGU9ImZpbGw6I2M1ZjNmMTtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC40NTc2MTg7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kIgogICAgICAgaW5rc2NhcGU6dHJhbnNmb3JtLWNlbnRlci14PSIzOS44MTI2NDciCiAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9IjU0Ljc5NzQxMiIKICAgICAgIGQ9Im0gMjIuNTEwMTYsODYuNTgxNzEzIGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCAtNy44MTk2MSwyNS41NTA1ODcgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCAxLjc0NDIyNyw1LjcxODI1IDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgNS41MTQ2OTQsLTIuMzA4NyAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDEyLjU0MTY0MywtMzYuMTMzNjUyIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgLTExLjk4MDk1NCw3LjE3MzUxNSB6IiAvPgogICAgPHBhdGgKICAgICAgIGlkPSJjaXJjbGUxNDUyNSIKICAgICAgIHN0eWxlPSJmaWxsOiNlNmUwODA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuNDU3NjE4O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZCIKICAgICAgIGlua3NjYXBlOnRyYW5zZm9ybS1jZW50ZXIteT0iLTY3LjczMzMzIgogICAgICAgZD0ibSAtMTAuNTMzOTY1LDY4Ljg3NjM5OSBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMy44OTk5MjQyLDQuNTMxNTI2IDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMzguMjU0Nzk5OCwwLjc0OTk4IDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgLTM3LjI1NTIwNCwtOC43MDczOTYgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCAtNC44OTk1MiwzLjQyNTg5IHoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMTk4NCIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiNmZmZmMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0ibSAtOS4yNDU3NTAzLDEwNS43MDUxIHYgNy40NTEyMyBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMy40NzI2NTYsMi4yODYxNiB2IC0xLjUxMDUgYyAwLC0yLjA4MDgzIC0wLjA1NTEyLC0zLjQzODIgLTAuMTY1MzY0LC00LjA3MjEgaCAwLjEyNDAyMyBjIDAuMjQ4MDQ3LDAuNjQ3NjggMC41NjQ5OTcsMS4yNjc4IDAuOTUwODQ3LDEuODYwMzUgbCAzLjc1NDI5MjcsNS44MTQxMSBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgNC42Njg0NDg1LDEuMTczNTggTCAtNC43Mzk1NjUzLDEwNS43MDUxIFogbSAyMC40MjI1MjYzLDAgdiAxMy4yMDU5MSBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMy40NzI2NTYsLTAuNTg3NTYgdiAtNi40MzYzIGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMSAtMC40NDcwMDEsLTYuMTgyMDUgeiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDIyNDQ4IgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTo0Mi4zMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpHYWR1Z2k7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpHYWR1Z2k7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBkPSJtIDE0LjIwMTkxNCwxMDUuNzA1MSBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMC40NDc1MTgsNi4xNzE3MiB2IC02LjE3MTcyIHoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMjUyMiIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiM2ODkyYmM7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0ibSAtOS4yNDU3NTAzLDExMy4xNzY0OCB2IDIyLjE3MDIyIGggMy40NzI2NTYgdiAtMTkuODkxODEgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIC0zLjQ3MjY1NiwtMi4yNzg0MSB6IG0gOC4xNDIxMzg3LDQuMzY2NjYgMTEuNDk0OTA1NiwxNy44MDM1NiBoIDQuMjU4MTM4IHYgLTE3LjAxMjkxIGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMSAtMy40NzI2NTYsMC41ODU0OSB2IDcuNjYzMSBjIDAsMi4wNTMyNyAwLjA2ODksMy41MDcxMSAwLjIwNjcwNiw0LjM2MTQ5IGggLTAuMDgyNjggYyAtMC4xNzkxNDQsLTAuMzU4MjggLTAuNTc4Nzc3LC0xLjAxOTc1IC0xLjE5ODg5MywtMS45ODQzNyBMIDMuNTU4NjM2MSwxMTguNzA3NDEgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIC00LjY2MjI0NzcsLTEuMTY0MjcgeiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDIzMjUzIgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTo0Mi4zMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpHYWR1Z2k7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpHYWR1Z2k7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2ZmZmZmZjtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBkPSJtIDIyLjQyMTU2NywxMDUuNzA1MSB2IDkuNTY5OTYgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDMuNDcyNjU3LC0yLjM1ODUxIHYgLTQuMDY5NTIgaCA0LjE3OTA3MyBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMi4yODQwOTgsLTMuMTQxOTMgeiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDIzMjU4IgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTo0Mi4zMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpHYWR1Z2k7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpHYWR1Z2k7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6IzAwZmZmZjtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBkPSJNIDMyLjM1NzM5NSAxMDUuNzA1MSBBIDI4LjU5MjA1MiAyOC41OTIwNTIgMCAwIDEgMzAuMDczMjk3IDEwOC44NDcwMyBMIDM3LjQ2OTc0NSAxMDguODQ3MDMgTCAzNy40Njk3NDUgMTA1LjcwNTEgTCAzMi4zNTczOTUgMTA1LjcwNTEgeiBNIDI1Ljg5NDIyNCAxMTIuOTE2NTUgQSAyOC41OTIwNTIgMjguNTkyMDUyIDAgMCAxIDIyLjQyMTU2NyAxMTUuMjc1MDYgTCAyMi40MjE1NjcgMTI2LjgyNjI5IEEgMjguNTkyMDUyIDI4LjU5MjA1MiAwIDAgMCAyNS44OTQyMjQgMTI5LjgzMDc2IEwgMjUuODk0MjI0IDEyMS44MjgxNSBMIDM2LjYwMTU4IDEyMS44MjgxNSBMIDM2LjYwMTU4IDExOC43MDY4OSBMIDI1Ljg5NDIyNCAxMTguNzA2ODkgTCAyNS44OTQyMjQgMTEyLjkxNjU1IHogTSAyOS43NjQyNzIgMTMyLjIwNDc4IEEgMjguNTkyMDUyIDI4LjU5MjA1MiAwIDAgMCAzOC4xMzEyMDMgMTM0Ljk1MDg2IEwgMzguMTMxMjAzIDEzMi4yMDQ3OCBMIDI5Ljc2NDI3MiAxMzIuMjA0NzggeiAiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMzMzMiIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiM2ODkyYmM7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0ibSAyMi40MjE1NjcsMTI2LjgzNzY2IHYgOC41MDkwNCBoIDE1LjcwOTYzNiB2IC0wLjM4Mzk1IGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMSAtOC4zNzEwNjUsLTIuNzU3OTcgaCAtMy44NjU5MTQgdiAtMi4zNzk3IGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMSAtMy40NzI2NTcsLTIuOTg3NDIgeiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDIzMzM3IgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTo0Mi4zMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpHYWR1Z2k7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpHYWR1Z2k7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2JjZmZmZjtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBkPSJtIDYwLjE4NjcwNCwxMDUuNzA1MSAtMC4xODM0NTEsMC4zMDA3NiBhIDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDAgMy40MTI3MTEsMC44OTc2MiBsIDAuNzYwMTYxLC0xLjE5ODM4IHoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMzQxMSIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiMwMGZmZmY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0iTSA0MS4yNzMxMyAxMDUuNzA1MSBMIDUwLjQwOTUyMyAxMjAuNDQzMjIgTCA0MC41NTc5MjggMTM1LjI0MTI4IEEgMjguNTkyMDUyIDI4LjU5MjA1MiAwIDAgMCA0NC44MDI2MyAxMzUuMjU1MjQgTCA1MS43NzM3ODEgMTIzLjk5ODU2IEMgNTIuMTA0NTEgMTIzLjMzNzEgNTIuMzM4Nzc4IDEyMi44NDc4OSA1Mi40NzY1OCAxMjIuNTMwOTUgTCA1Mi41NTkyNjMgMTIyLjUzMDk1IEMgNTIuODA3MzA5IDEyMy4xNjQ4NCA1My4wMzQ2ODcgMTIzLjY1NDA1IDUzLjI0MTM5MiAxMjMuOTk4NTYgTCA1Ny41NzgwNzggMTMxLjIxMzExIEEgMjguNTkyMDUyIDI4LjU5MjA1MiAwIDAgMCA2MC40MzY4MTggMTI5LjIzNDQyIEwgNTQuODUzNjk2IDEyMC40MDE4OCBMIDYzLjQxNTk2NCAxMDYuOTAzNDggQSAyOC41OTIwNTIgMjguNTkyMDUyIDAgMCAxIDYwLjAwMzI1MyAxMDYuMDA1ODYgTCA1My44ODIxNzkgMTE2LjA0MDM5IEMgNTMuNTUxNDUyIDExNi41NjQwNCA1My4xNjU1OTkgMTE3LjI4MDYyIDUyLjcyNDYyNyAxMTguMTkwMTMgTCA1Mi42NDE5NDUgMTE4LjE5MDEzIEMgNTIuMzM4Nzc3IDExNy41MDExMSA1MS45ODczNzYgMTE2LjgxMjA5IDUxLjU4Nzc0NiAxMTYuMTIzMDcgTCA0NS41MzEyNjggMTA1LjcwNTEgTCA0MS4yNzMxMyAxMDUuNzA1MSB6ICIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDIzNDE2IgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTo0Mi4zMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpHYWR1Z2k7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpHYWR1Z2k7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6IzY4OTJiYztmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBkPSJtIDYwLjQzNzg1MiwxMjkuMjM2NDggYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIC0yLjg1OTI1NywxLjk3NzY2IGwgMi40ODQwODYsNC4xMzI1NiBoIDQuMjM3NDY3IHogbSAtMTkuODkwMjU5LDYuMDE5NzkgLTAuMDU5OTQsMC4wOTA0IGggNC4yNTgxMzggbCAwLjA0OTA5LC0wLjA3OTEgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIC00LjI0NzI4NiwtMC4wMTE0IHoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMzQyMSIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiNiY2ZmZmY7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0ibSA2NS43Njc3NTksMTA1LjcwNTEgdiAxLjU2MTE1IGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCA1LjU3Nzk1NCwwLjA2OTIgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMCAtMC4wMDk4LC0xLjYzMDM5IHoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMzQ5NSIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiNiY2ZmMzA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0ibSA3MS4zMzUzNzgsMTA1LjcwNTEgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIDAuMDEwMzMsMS42MjIxMyAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDcuMzY5NTc2LC0xLjYyMjEzIHoiIC8+CiAgICA8cGF0aAogICAgICAgaWQ9InBhdGgyMzU3MiIKICAgICAgIHN0eWxlPSJmb250LXNpemU6NDIuMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6R2FkdWdpOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246R2FkdWdpO21peC1ibGVuZC1tb2RlOm5vcm1hbDtmaWxsOiM2ODkyYmM7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjY0NTgzIgogICAgICAgZD0ibSA3OC43NDYyOTUsMTA1LjcwNTEgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIC03LjM4ODY5NiwxLjYzNTA0IDI4LjU5MjA1MiwyOC41OTIwNTIgMCAwIDEgLTAuMDcwOCwxLjUwNjg5IGggMy4wMTc5MDMgdiAyNi40OTk2NyBoIDMuNDcyNjU3IHYgLTI2LjQ5OTY3IGggOC41NTc2MTcgdiAtMy4xNDE5MyB6IiAvPgogICAgPHBhdGgKICAgICAgIGlkPSJwYXRoMjM1ODEiCiAgICAgICBzdHlsZT0iZm9udC1zaXplOjQyLjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OkdhZHVnaTstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkdhZHVnaTttaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDojMDBmZmZmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGQ9Im0gNzEuMzM1ODk0LDEwNS43MDUxIGEgMjguNTkyMDUyLDI4LjU5MjA1MiAwIDAgMSAwLjAwOTgsMS42MzAzOSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAxIC01LjU3Nzk1NCwtMC4wNjMgdiAxLjU3NDU4IGggNS41MTg1MjYgYSAyOC41OTIwNTIsMjguNTkyMDUyIDAgMCAwIDAuMDU4MzksLTMuMTQxOTMgeiIgLz4KICAgIDxwYXRoCiAgICAgICBpZD0icGF0aDI1NjMwIgogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTo0Mi4zMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpHYWR1Z2k7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpHYWR1Z2k7bWl4LWJsZW5kLW1vZGU6bm9ybWFsO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjQ1ODMiCiAgICAgICBkPSJNIDIyLjQyMTU2NyAxMDUuNzA1MSBMIDIyLjQyMTU2NyAxMTUuMjc1MDYgQSAyOC41OTIwNTIgMjguNTkyMDUyIDAgMCAwIDI1Ljg5NDIyNCAxMTIuOTE2NTUgTCAyNS44OTQyMjQgMTA4Ljg0NzAzIEwgMzAuMDczMjk3IDEwOC44NDcwMyBBIDI4LjU5MjA1MiAyOC41OTIwNTIgMCAwIDAgMzIuMzU3Mzk1IDEwNS43MDUxIEwgMjIuNDIxNTY3IDEwNS43MDUxIHogIiAvPgogICAgPHBhdGgKICAgICAgIGlkPSJwYXRoMjU2MzgiCiAgICAgICBzdHlsZT0iZm9udC1zaXplOjQyLjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OkdhZHVnaTstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkdhZHVnaTttaXgtYmxlbmQtbW9kZTpub3JtYWw7ZmlsbDojYmNmZmZmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGQ9Ik0gNjAuMTg2NzA0IDEwNS43MDUxIEwgNjAuMDAzMjUzIDEwNi4wMDU4NiBBIDI4LjU5MjA1MiAyOC41OTIwNTIgMCAwIDAgNjMuNDE1OTY0IDEwNi45MDM0OCBMIDY0LjE3NjEyNSAxMDUuNzA1MSBMIDYwLjE4NjcwNCAxMDUuNzA1MSB6ICIgLz4KICA8L2c+Cjwvc3ZnPgo='

export default {
  props: {
    text: {
      type: String,
      default: null
    },
    showCode: {
      type: Boolean,
      default: true
    },
    isTrialCode: {
      type: Boolean,
      default: true
    }
  },
  computed: {
    ...mapGetters([
      'storeDarkMode'
    ]),
    code: function () {
      if (this.text) {
        if (this.isTrialCode) {
          const uuidPart = this.$router.resolve({ name: 'trial-import', params: { shareCode: this.text } }).resolved.path
          let origin = window.location.origin
          let pathname = window.location.pathname

          if (origin.lastIndexOf('/') === origin.length - 1) {
            origin = origin.substring(0, origin.length - 1)
          }
          if (pathname.length > 0 && pathname[0] === '/') {
            pathname = pathname.substring(1)
          }
          if (pathname.lastIndexOf('/') === pathname.length - 1) {
            pathname = pathname.substring(0, pathname.length - 1)
          }

          if (pathname.length > 0) {
            pathname = pathname + '/'
          }

          return origin + '/' + pathname + '#' + uuidPart
        } else {
          return this.text
        }
      } else {
        return null
      }
    }
  },
  watch: {
    code: function () {
      this.updateBarcode()
    }
  },
  methods: {
    updateBarcode: function () {
      if (this.code) {
        this.$nextTick(() => {
          if (!this.codeWriter) {
            this.codeWriter = new QRCodeStyling({
              margin: this.storeDarkMode ? 20 : 0,
              width: 300,
              height: 300,
              data: this.code,
              dotsOptions: {
                type: 'rounded'
              },
              imageOptions: {
                hideBackgroundDots: true,
                imageSize: 0.4,
                margin: 10
              },
              image: imageData
            })
            this.codeWriter.append(this.$refs.svg)
          } else {
            this.codeWriter.update({
              data: this.code
            })
            this.codeWriter.append(this.$refs.svg)
          }
        })
      } else {
        // TODO
      }
    }
  },
  mounted: function () {
    this.updateBarcode()
  }
}
</script>

<style>
</style>
